<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Friend Finder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
        <div style="width: 968px; margin:auto;" class="jumbotron">
            <a href="/">Home</a>
            <h1 class="display-4">Survey</h1>
            <p class="lead">Fill out ten questions and find your new best friend!</p>
            <hr class="my-4">
            <p>What is your name?</p>
            <div class="container">   
                <input style="width: 30%;" class="form-control user-name" type="text">
            </div>
            <p class="question">1) How much do you enjoy listening to music?</p>
                <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div1" data-value='1' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (Not at all)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (Music is my savior)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">2) How much do you enjoy outdoor activities such as camping and hiking?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div2" data-value='2' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (Not at all)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (I practically live in a tent) </a></li>
                    </ul>
                </div>
            </div>
            <p class="question">3) How much do you like dogs?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div3" data-value='3' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (I can't stand dogs)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (I can't live without puppers)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">4) How much do you like cats? </p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div4" data-value='4' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (I despise furballs)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (I love cats)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">5) How much do you like scary movies?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div5" data-value='5' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (They give me nightmares for days)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (I can't get enough)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">6) Do you tend to be a night owl?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div6" data-value='6' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (Nope! Bedtime by 8pm)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (I don't remember the last time I was asleep before 3am)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">7) Are you a foodie?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div7" data-value='7' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (Practically anorexic)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (Nom Nom Nom)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">8) How much do you like coffee?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div8" data-value='8' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (Why would I drink something made from beans?)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (Coffee. Before. Anything.)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">9) How much do you like tea?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div9" data-value='9' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (I don't enjoy earthy hot water)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (Tea is life.)</a></li>
                    </ul>
                </div>
            </div>
            <p class="question">10) How much did you enjoy this questionaire?</p>
            <div class="container">                                         
                <div class="dropdown">
                    <button class="btn btn-primary dropdown-toggle answer-div10" data-value='10' type="button" data-toggle="dropdown">Choose Here
                    <span class="caret"></span></button>
                    <ul class="dropdown-menu">
                    <li><a class='answer' data-value='1'>1 (It was a waste of my time)</a></li>
                    <li><a class='answer' data-value='2'>2</a></li>
                    <li><a class='answer' data-value='3'>3</a></li>
                    <li><a class='answer' data-value='4'>4</a></li>
                    <li><a class='answer' data-value='5'>5 (I loved it!)</a></li>
                    </ul>
                </div>
            </div>
            <br><br><br>
            <div class="container">       
                <button type="button" class="btn-lg btn-primary submit" data-toggle="modal" data-target="#friendResult">Submit</button>
            </div>
        </div>

  
        <!-- Modal -->
        <div class="modal fade" id="friendResult" tabindex="-1" role="dialog" aria-labelledby="friendResultTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h2 class="modal-title" id="exampleModalLongTitle"></h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                </button>
                </div>
                <div class="modal-body">
                ...
                </div>
                <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
            </div>
        </div>
        <script>
            let buttonNumber = null;
            

            $('.dropdown-toggle').on("click", function() {
                buttonNumber = parseInt($(this).attr('data-value'));
            })
            $('.answer').on("click", function() {
                answerValue = parseInt($(this).attr('data-value'));
                for(let i = 1; i <= 10; i++) {
                    if(i === buttonNumber) {
                        $('.answer-div' + i).text(answerValue);
                    }
                }
            });
            $('.submit').on('click', function(event) {
                event.preventDefault();
                let scores = [];
                for(let i = 1; i <= 10; i++) {
                    scores.push($('.answer-div' + i).text());
                }
                //console.log(scores);
                let friendAnswers = {
                    name: $('.user-name').val().trim(),
                    scores: scores
                }
                function scoresValid() {
                    for(let i = 1; i <= 10; i++) {
                        scores[i] = parseInt(scores[i]);
                        console.log(typeof(scores[i]));
                        if(typeof(scores[i]) === "number" ) {
                            return true;
                        }
                        else {
                            return false;
                        }
                    }
                }
                scoresValid();
                if(!friendAnswers.name || !scoresValid()) {
                    console.log("name doesn't exist");
                    $(".modal-title").text("OOPS!");
                    $(".modal-body").text("Please make sure all fields have been filled in completely.")
                }
                else {
                    $(".modal-title").text("Success!");
                    $(".modal-body").text("Your new best friend is ")
                    $.post("/api/friends", friendAnswers, function(data) {
                    console.log("post has been made");
                    if(data) {
                        alert("Yahoooooo");
                    }
                    else {
                        alert("skrrrt");
                    }
                });
                }
            });

        </script>
</body>
</html>